function H = WL11_LDPCmatrix(R,n)
%---
%   v.0 Matrix prototypes of parity-check matrices for coding rates 'R'
%       at codeword block length 'n'. The integer i denotes the
%       cyclic-permutation matrix Pi, as illustrated in Figure 19-12.
%           -(-99) entries of the table denote null (zero) submatrices.
%---

switch n
    case 648
        Z = 27;
        switch R
            case 1/2
                M = [0 -99 -99 -99 0 0 -99 -99 0 -99 -99 0 1 0 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99;
                    22 0 -99 -99 17 -99 0 0 12 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99 -99 -99;
                    6 -99 0 -99 10 -99 -99 -99 24 -99 0 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99 -99;
                    2 -99 -99 0 20 -99 -99 -99 25 0 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99;
                    23 -99 -99 -99 3 -99 -99 -99 0 -99 9 11 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99;
                    24 -99 23 1 17 -99 3 -99 10 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99;
                    25 -99 -99 -99 8 -99 -99 -99 7 18 -99 -99 0 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99;
                    13 24 -99 -99 0 -99 8 -99 6 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99;
                    7 20 -99 16 22 10 -99 -99 23 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99;
                    11 -99 -99 -99 19 -99 -99 -99 13 -99 3 17 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99;
                    25 -99 8 -99 23 18 -99 14 9 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0;
                    3 -99 -99 -99 16 -99 -99 2 25 5 -99 -99 1 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0];
            case 2/3
                M = [25 26 14 -99 20 -99 2 -99 4 -99 -99 8 -99 16 -99 18 1 0 -99 -99 -99 -99 -99 -99;
                    10 9 15 11 -99 0 -99 1 -99 -99 18 -99 8 -99 10 -99 -99 0 0 -99 -99 -99 -99 -99;
                    16 2 20 26 21 -99 6 -99 1 26 -99 7 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99;
                    10 13 5 0 -99 3 -99 7 -99 -99 26 -99 -99 13 -99 16 -99 -99 -99 0 0 -99 -99 -99;
                    23 14 24 -99 12 -99 19 -99 17 -99 -99 -99 20 -99 21 -99 0 -99 -99 -99 0 0 -99 -99;
                    6 22 9 20 -99 25 -99 17 -99 8 -99 14 -99 18 -99 -99 -99 -99 -99 -99 -99 0 0 -99;
                    14 23 21 11 20 -99 24 -99 18 -99 19 -99 -99 -99 -99 22 -99 -99 -99 -99 -99 -99 0 0;
                    17 11 11 20 -99 21 -99 26 -99 3 -99 -99 18 -99 26 -99 1 -99 -99 -99 -99 -99 -99 0];
            case 3/4
                M = [16 17 22 24 9 3 14 -99 4 2 7 -99 26 -99 2 -99 21 -99 1 0 -99 -99 -99 -99
                    25 12 12 3 3 26 6 21 -99 15 22 -99 15 -99 4 -99 -99 16 -99 0 0 -99 -99 -99
                    25 18 26 16 22 23 9 -99 0 -99 4 -99 4 -99 8 23 11 -99 -99 -99 0 0 -99 -99
                    9 7 0 1 17 -99 -99 7 3 -99 3 23 -99 16 -99 -99 21 -99 0 -99 -99 0 0 -99
                    24 5 26 7 1 -99 -99 15 24 15 -99 8 -99 13 -99 13 -99 11 -99 -99 -99 -99 0 0
                    2 2 19 14 24 1 15 19 -99 21 -99 2 -99 24 -99 3 -99 2 1 -99 -99 -99 -99 0];
            case 5/6
                M = [17 13 8 21 9 3 18 12 10 0 4 15 19 2 5 10 26 19 13 13 1 0 -99 -99;
                    3 12 11 14 11 25 5 18 0 9 2 26 26 10 24 7 14 20 4 2 -99 0 0 -99;
                    22 16 4 3 10 21 12 5 21 14 19 5 -99 8 5 18 11 5 5 15 0 -99 0 0;
                    7 7 14 14 4 16 16 24 24 10 1 7 15 6 10 26 8 18 21 14 1 -99 -99 0];
        end
    case 1296
        Z = 54;
        switch R
            case 1/2
                M = [40 -99 -99 -99 22 -99 49 23 43 -99 -99 -99 1 0 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99;
                    50 1 -99 -99 48 35 -99 -99 13 -99 30 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99 -99 -99;
                    39 50 -99 -99 4 -99 2 -99 -99 -99 -99 49 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99 -99;
                    33 -99 -99 38 37 -99 -99 4 1 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99;
                    45 -99 -99 -99 0 22 -99 -99 20 42 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99;
                    51 -99 -99 48 35 -99 -99 -99 44 -99 18 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99;
                    47 11 -99 -99 -99 17 -99 -99 51 -99 -99 -99 0 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99;
                    5 -99 25 -99 6 -99 45 -99 13 40 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99;
                    33 -99 -99 34 24 -99 -99 -99 23 -99 -99 46 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99;
                    1 -99 27 -99 1 -99 -99 -99 38 -99 44 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99;
                    -99 18 -99 -99 23 -99 -99 8 0 35 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0;
                    49 -99 17 -99 30 -99 -99 -99 34 -99 -99 19 1 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0];
            case 2/3
                M = [39 31 22 43 -99 40 4 -99 11 -99 -99 50 -99 -99 -99 6 1 0 -99 -99 -99 -99 -99 -99;
                    25 52 41 2 6 -99 14 -99 34 -99 -99 -99 24 -99 37 -99 -99 0 0 -99 -99 -99 -99 -99;
                    43 31 29 0 21 -99 28 -99 -99 2 -99 -99 7 -99 17 -99 -99 -99 0 0 -99 -99 -99 -99;
                    20 33 48 -99 4 13 -99 26 -99 -99 22 -99 -99 46 42 -99 -99 -99 -99 0 0 -99 -99 -99;
                    45 7 18 51 12 25 -99 -99 -99 50 -99 -99 5 -99 -99 -99 0 -99 -99 -99 0 0 -99 -99;
                    35 40 32 16 5 -99 -99 18 -99 -99 43 51 -99 32 -99 -99 -99 -99 -99 -99 -99 0 0 -99;
                    9 24 13 22 28 -99 -99 37 -99 -99 25 -99 -99 52 -99 13 -99 -99 -99 -99 -99 -99 0 0;
                    32 22 4 21 16 -99 -99 -99 27 28 -99 38 -99 -99 -99 8 1 -99 -99 -99 -99 -99 -99 0];
            case 3/4
                M = [39 40 51 41 3 29 8 36 -99 14 -99 6 -99 33 -99 11 -99 4 1 0 -99 -99 -99 -99;
                    48 21 47 9 48 35 51 -99 38 -99 28 -99 34 -99 50 -99 50 -99 -99 0 0 -99 -99 -99;
                    30 39 28 42 50 39 5 17 -99 6 -99 18 -99 20 -99 15 -99 40 -99 -99 0 0 -99 -99;
                    29 0 1 43 36 30 47 -99 49 -99 47 -99 3 -99 35 -99 34 -99 0 -99 -99 0 0 -99;
                    1 32 11 23 10 44 12 7 -99 48 -99 4 -99 9 -99 17 -99 16 -99 -99 -99 -99 0 0;
                    13 7 15 47 23 16 47 -99 43 -99 29 -99 52 -99 2 -99 53 -99 1 -99 -99 -99 -99 0];
            case 5/6
                M = [48 29 37 52 2 16 6 14 53 31 34 5 18 42 53 31 45 -99 46 52 1 0 -99 -99;
                    17 4 30 7 43 11 24 6 14 21 6 39 17 40 47 7 15 41 19 -99 -99 0 0 -99;
                    7 2 51 31 46 23 16 11 53 40 10 7 46 53 33 35 -99 25 35 38 0 -99 0 0;
                    19 48 41 1 10 7 36 47 5 29 52 52 31 10 26 6 3 2 -99 51 1 -99 -99 0];
        end
    case 1944
        Z = 81;
        switch R
            case 1/2
                M = [57 -99 -99 -99 50 -99 11 -99 50 -99 79 -99 1 0 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99;
                    3 -99 28 -99 0 -99 -99 -99 55 7 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99 -99 -99;
                    30 -99 -99 -99 24 37 -99 -99 56 14 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99 -99;
                    62 53 -99 -99 53 -99 -99 3 35 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99 -99;
                    40 -99 -99 20 66 -99 -99 22 28 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99 -99;
                    0 -99 -99 -99 8 -99 42 -99 50 -99 -99 8 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99;
                    69 79 79 -99 -99 -99 56 -99 52 -99 -99 -99 0 -99 -99 -99 -99 -99 0 0 -99 -99 -99 -99;
                    65 -99 -99 -99 38 57 -99 -99 72 -99 27 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99 -99;
                    64 -99 -99 -99 14 52 -99 -99 30 -99 -99 32 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99 -99;
                    -99 45 -99 70 0 -99 -99 -99 77 9 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0 -99;
                    2 56 -99 57 35 -99 -99 -99 -99 -99 12 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0 0;
                    24 -99 61 -99 60 -99 -99 27 51 -99 -99 16 1 -99 -99 -99 -99 -99 -99 -99 -99 -99 -99 0];
            case 2/3
                M = [61 75 4 63 56 -99 -99 -99 -99 -99 -99 8 -99 2 17 25 1 0 -99 -99 -99 -99 -99 -99;
                    56 74 77 20 -99 -99 -99 64 24 4 67 -99 7 -99 -99 -99 -99 0 0 -99 -99 -99 -99 -99;
                    28 21 68 10 7 14 65 -99 -99 -99 23 -99 -99 -99 75 -99 -99 -99 0 0 -99 -99 -99 -99;
                    48 38 43 78 76 -99 -99 -99 -99 5 36 -99 15 72 -99 -99 -99 -99 -99 0 0 -99 -99 -99;
                    40 2 53 25 -99 52 62 -99 20 -99 -99 44 -99 -99 -99 -99 0 -99 -99 -99 0 0 -99 -99;
                    69 23 64 10 22 -99 21 -99 -99 -99 -99 -99 68 23 29 -99 -99 -99 -99 -99 -99 0 0 -99;
                    12 0 68 20 55 61 -99 40 -99 -99 -99 52 -99 -99 -99 44 -99 -99 -99 -99 -99 -99 0 0;
                    58 8 34 64 78 -99 -99 11 78 24 -99 -99 -99 -99 -99 58 1 -99 -99 -99 -99 -99 -99 0];
            case 3/4
                M = [48 29 28 39 9 61 -99 -99 -99 63 45 80 -99 -99 -99 37 32 22 1 0 -99 -99 -99 -99;
                    4 49 42 48 11 30 -99 -99 -99 49 17 41 37 15 -99 54 -99 -99 -99 0 0 -99 -99 -99;
                    35 76 78 51 37 35 21 -99 17 64 -99 -99 -99 59 7 -99 -99 32 -99 -99 0 0 -99 -99;
                    9 65 44 9 54 56 73 34 42 -99 -99 -99 35 -99 -99 -99 46 39 0 -99 -99 0 0 -99;
                    3 62 7 80 68 26 -99 80 55 -99 36 -99 26 -99 9 -99 72 -99 -99 -99 -99 -99 0 0;
                    26 75 33 21 69 59 3 38 -99 -99 -99 35 -99 62 36 26 -99 -99 1 -99 -99 -99 -99 0];
            case 5/6
            M = [13 48 80 66 4 74 7 30 76 52 37 60 -99 49 73 31 74 73 23 -99 1 0 -99 -99;
                69 63 74 56 64 77 57 65 6 16 51 -99 64 -99 68 9 48 62 54 27 -99 0 0 -99;
                51 15 0 80 24 25 42 54 44 71 71 9 67 35 -99 58 -99 29 -99 53 0 -99 0 0;
                16 29 36 41 44 56 59 37 50 24 -99 65 4 65 52 -99 4 -99 73 52 1 -99 -99 0];
        end
end

H = zeros(27*size(M));

for row = 1:size(M,1)
    for clmn = 1:size(M,2)
        if M(row,clmn)~=-99
            H((row-1)*Z+1:row*Z,(clmn-1)*Z+1:clmn*Z ) = ...
                circshift(eye(Z),M(row,clmn),2);
        else
        end
        
    end
end
